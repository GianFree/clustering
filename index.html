<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
  <LINK REL="stylesheet" HREF="http://physiology.med.cornell.edu/resources/physbio.css" TYPE="text/css">
  <LINK REL="stylesheet" HREF="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/vmd.css" TYPE="text/css">
  <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
  <TITLE>VMD plugin Cluster</TITLE>
  <META NAME="AUTHOR" CONTENT="Luis Gracia">
</HEAD>
<BODY LANG="en-US">

<TABLE WIDTH=750 ALIGN=center>
<TR><TD><A HREF="http://physiology.med.cornell.edu/"><IMG SRC="http://physiology.med.cornell.edu/images/header.jpg" BORDER=0 ALT="physiology"></A></TD></TR>
<TR><TD>

<H4><A HREF="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/index.html">VMD plugins at WMC Physiology & Biophysics</A></H4>
<H1>Cluster: Clustering Tool </H1>

<H3>
<A HREF="#description">Description</A> |
<A HREF="#usage">Usage</A> |
<A HREF="#download">Download</A> |
<A HREF="#install">Installation</A> |
<A HREF="#author">Author</A>
</H3>

<H2><A NAME="description">Description</A></H2>

<EM>Cluster</EM> is a VMD plugin to visualize clusters of conformations of a structure. Each conformation is color coded according to the cluster to which it belongs. This is done by creating one representation for each cluster, and setting the <EM>Draw Multiple frames</EM> variable to the corresponding frame numbers.

<P>Features include:</P>
<UL>
  <LI>Import results from:
    <UL>
      <LI><A HREF="http://neon.chem.le.ac.uk/nmrclust/">NMRCLUSTER</A> (link doesn't work anymore).
      <LI><A HREF="http://www.schrodinger.com/">Xcluster</A>.
      <LI><A HREF="http://www.r-project.org/">R</A> hierarchical <A HREF="http://cran.r-project.org/src/contrib/Descriptions/cluster.html">clustering</A>.
      <LI><A HREF="http://www.gromacs.org">Gromacs</A> clustering utility <A HREF="http://www.gromacs.org/documentation/reference/online/g_cluster.html">g_cluster</A>.
    </UL>
  <LI>Color conformations by cluster.
  <LI>Selection of clusters and/or conformations to display.
  <LI>Multiple levels of clustering.
  <LI>Custom representation.
  <LI>Join single member clusters in a separate cluster.
</UL>

<CENTER><TABLE>
  <TR>
    <TD><IMG SRC="cluster1.png" NAME="cluster1" BORDER=0></TD>
    <TD><IMG SRC="cluster2.png" NAME="cluster2" BORDER=0></TD>
  </TR>
</TABLE></CENTER>

<H2><A NAME="usage">Usage</A></H2>

<P>To use the <EM>Cluster plugin</EM> you need:

<OL>
  <LI><B>Load a trajectory</B> of the conformations used for clustering into VMD.
  <LI>Define the <B>atom selection</B> and <B>molecule</B> to use as representation in vmd.
  <LI><B>Generate</B> the clusters with <EM>NMRCLUSTER</EM>, <EM>Xcluster</EM> or <EM>R</EM> and <B>Import</B> the results into the plugin:
  <UL>
    <LI>For <B>NMRCLUSTER</B> import the <EM>"Cluster.log"</EM> file. Only a level (0) will be available. Outliers will be splitted in different clusters. Use the <EM>Join 1 member clusters</EM> to cluster them together.
    <LI>For <B>Xcluster</B> import the <EM>".clg"</EM> file. All levels of interest must be saved in order to display them in VMD (look in the Xcluster manual for the <EM>Writecls</EM> command).
    <LI>For <B>R</B> follow this procedure:
    <OL>
      <LI>Obtain the rmsd between structures. You can use the <A HREF="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/itrajcomp">iTrajComp</A> plugin for and easy way of doing this (I suggest writing the results in matrix format).
      <LI>Load the data into R and use one of the available functions in R to do hierarchical clustering (<EM>hclust</EM>, <EM>agnes</EM>, <EM>diana</EM>, ...). If you used the <A HREF="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/itrajcomp">iTrajComp</A> plugin to create the rmsd matrix, the following should work in R (see the documentation of the individual commands for further options):
      <PRE>
        data = scan('/path/to/rmsd.mat')
        rmsd = matrix(data, nrow=sqrt(length(data)), ncol=sqrt(length(data)))
        library(cluster)
        cluster = agnes(rmsd, diss=T)
      </PRE>
      <LI>Cut the tree into groups (levels) using <EM>cutree</EM>. You can cut into one or more groupings. For example
      <PRE>
        levels = cutree(cluster, k=2:5)
      </PRE>
      will output the cluster membership of each object for levels 2 to 5.
      <LI>Write the results to a file to input into the Cluster plugin:
      <PRE>
        write.table(levels, file='levels.dat', quote=F)
      </PRE>
      <LI>Import the file into the Cluster plugin.
    </OL>
    <LI>For <B>Gromacs (g_cluster)</B> import the <EM>"cluster.log"</EM> file. Only a level (0) will be available.
  </UL>
  <LI>Managing the GUI:
  <UL>
    <LI>Select the <B>level</B> you want to see. The list of clusters will be updated together with the colors of the conformations. All clusters will be displayed when you change the level.
    <LI>Select/Deselect <B>clusters</B> to activate/deactivate them.
    <LI>Select/Deselect <B>conformations</B> to activate/deactivate individual conformations.
    <LI><B>All</B> and <B>None</B> turn on/off all the clusters and conformations.
    <LI>Activate <B>Join 1 member clusters</B> to display all single member clusters in a separate cluster (<EM>outl</EM>).
    <LI>The <B>atom selection</B> to represent can be changed in the atom selection box. Click the <EM>Update Selection</EM> button to apply the changes.
  </UL>
</OL>

<H2><A NAME="download">Download</A></H2>

Send a mail to the <A HREF="#author">author</A> if you would like to be informed about new updates of this plugin.

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B><A NAME="Cluster_last">1.7</A> (6 Feb'08)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/cluster-v1.7.tgz">download</A>]</TD>
  </TR><TR>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Change log:
  <UL>
    <LI>Add support for cluster output from Gromacs utility g_cluster.
    <LI>Fix colors when doing multiple imports.
    <LI>Fix display of the 'outl' cluster.
  </UL></TD>
  </TR>
</TABLE>

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B><A NAME="Cluster_last">1.6</A> (13 Aug'07)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/cluster-v1.6.tgz">download</A>]</TD>
  </TR><TR>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Change log:
  <UL>
    <LI>Added support for cluster output from R.
    <LI>'Join 1 member' clusters works interactively (not just on import).
    <LI>Upgraded number of colors to the vmd maximum.
  </UL></TD>
  </TR>
</TABLE>

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B>1.5 (6 Apr'05)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/1.5/cluster.tcl">download</A>]</TD>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2><B>Note:</B>
    Remember to change pkgIndex.tcl and the .vmdrc to reflect the change (see <A HREF="#install">Installation notes</A>).
    </TD>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Change log:
  <UL>
  <LI>Namespace changed from CLUSTER to clustering. There was a clash with another plugin new in VMD 1.8.3.
  </UL></TD>
  </TR>
</TABLE>

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B>1.4 (18 Jan'05)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/1.4/cluster.tcl">download</A>]</TD>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Change log:
  <UL>
  <LI>Solved bug with colors when using more than 17 clusters. 
  <LI>Finished option to join cluster of 1 member together in cluster "outliers" (outl).
  <LI>Selection of molecule recovered.
  <LI>Parsing of Xcluster .clg file simplified.
  <LI>Added button to change atom selection.
  </UL></TD>
  </TR>
</TABLE>

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B>1.3 (18 Jan'05)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/1.3/cluster.tcl">download</A>]</TD>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Change log:
  <UL>
  <LI>Added support for Xcluster:
  <UL>
    <LI>Added new listbox with levels of clustering. Added another dimension to cluster.
  </UL>
  <LI>Added Options frame with:
  <UL>
    <LI>Atom selection for the representations.
    <LI>Starting to add option to join cluster of 1 member together, although is not activated yet.
  </UL>
  <LI>Minimized number of representations. Now each representation holds one cluster instead of one conformation.
  </UL></TD>
  </TR>
</TABLE>

<TABLE WIDTH=650 CLASS="plugin">
  <TR>
    <TD CLASS="vertit"><B>1.2 (17 Aug'04)</B></TD>
      <TD CLASS="verdown">[<A HREF="versions/1.2/cluster.tcl">download</A>]</TD>
  </TR><TR>
    <TD CLASS="verlog" COLSPAN=2>Initial version.</TD>
  </TR>
</TABLE>

<H2><A NAME="install">Installation</A></H2>

<OL>
<LI><B>Download</B> the plugin from <A HREF="#download">here</A> to the directory where you store your VMD plugins.
<LI>Add the following to your <B><EM>.vmdrc</EM></B> startup file (or create one) (for unix the path should be <EM>$HOME/.vmdrc</EM>, and for windows <EM>%USERPROFILE%\vmd.rc</EM>):
  <OL type="a">
  <LI><B>For VMD 1.8.3 and up</B>
<PRE>
lappend auto_path {/path/to/your/plugins/directory}
vmd_install_extension clustering clustering "WMC PhysBio/Cluster"
</PRE>
  <LI><B>For VMD 1.8.2 and down</B>
<PRE>
lappend auto_path {/path/to/your/plugins/directory}
if { [catch "package require clustering" msg] } {
  puts "VMD Cluster package could not be loaded:\n$msg"
} elseif { [catch {menu tk register "Cluster" clustering} msg] } {
  puts "VMD Cluster could not be started:\n$msg"
}
</PRE>
  </OL>
<P>Remember to correct the path to your plugins directory; i.e, if you saved the plugin in <EM>/home/user/myplugins</EM>, write that same path in the <EM>auto_path</EM> line.
<P><B>Note:</B> If you created the <EM>.vmdrc</EM> file, remember to add <B><EM>menu main on</EM></B> to get the main menu back.</P>

<LI><B>Start</B> VMD. The Cluster plugin should be accessible from the <EM>Extensions menu</EM>.</P>

<H2><A NAME="author">Author</A></H2>

<P>Send comments and feedback to <A HREF="mailto:lug2002@med.cornell.edu">Luis Gracia</A>.</P>

</TD></TR>

<TR><TD CLASS="footer">Copyright &copy; 2004-2008, Weill Cornell Medical College. All Rights Reserved</TD></TR>

<TR><TD CLASS="address">
<ADDRESS>
<A HREF="mailto:lug2002@med.cornell.edu">Luis Gracia</A>
| last updated: Tuesday, February 6, 2008
<!--#config  timefmt="%A %e/%m/%y"--><!--#echo var="LAST_MODIFIED"-->
</ADDRESS>
</TD></TR>

</BODY>
</HTML>
