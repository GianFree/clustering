<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="iso-8859-1">

    <title>Cluster plugin for VMD</title>

    <meta name="author" content="Luis Gracia">

    <link rel="stylesheet" href="../html5-reset.css">
    <link rel="stylesheet" href="../vmd.css">
    <link rel="stylesheet" href="cluster.css">
  </head>

  <body>
    <div id="container">
      <header>
        <a href="http://physiology.med.cornell.edu/"><img src="http://physiology.med.cornell.edu/images/header.jpg" alt="physiology"/></a>
        <div id="back-main"><a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins">VMD plugins at WMC Physiology &amp; Biophysics</a></div>
        <h1>Cluster: Clustering Tool</h1>
      </header>

      <nav>
        <ul>
          <li><a href="#description">Description</a></li>
          <li><a href="#manual">Manual</a></li>
          <li><a href="#download">Download</a></li>
          <li><a href="#install">Installation</a></li>
          <li><a href="#author">Author</a></li>
        </ul>
      </nav>
      
      <div id="main">
        <section id="description">
          <header>
            <h1>Description</h1>
          </header>
          <em>Cluster</em> is a VMD plugin to visualize clusters of conformations of a structure. Each conformation is color coded according to the cluster to which it belongs. This is done by creating one representation for each cluster, and setting the <em>Draw Multiple frames</em> variable to the corresponding frame numbers.
          
          <p>Features include:</p>
          <ul>
            <li>Import results from:
              <ul>
                <li><a href="http://neon.chem.le.ac.uk/nmrclust/">NMRCLUSTER</a> (link doesn't work anymore).</li>
                <li><a href="http://www.schrodinger.com/">Xcluster</a>.</li>
                <li><a href="http://www.r-project.org/">R</a> hierarchical <a href="http://cran.r-project.org/src/contrib/Descriptions/cluster.html">clustering</a>.</li>
                <li><a href="http://www.gromacs.org">Gromacs</a> clustering utility <a href="http://www.gromacs.org/documentation/reference/online/g_cluster.html">g_cluster</a>.</li>
                <li><a href="http://http://www.charmm.org">Charmm</a> clustering <a href="http://http://www.charmm.org/documentation/c35b1/correl.html#%20Cluster">command</a>.</li>
              </ul>
            </li>
            <li>Color conformations by cluster.</li>
            <li>Selection of clusters and/or conformations to display.</li>
            <li>Multiple levels of clustering.</li>
            <li>Custom representation.</li>
            <li>Join single member clusters in a separate cluster.</li>
          </ul>
          
          <div class="center columns">
            <img src="cluster1.png" name="cluster1">
            <img src="cluster2.png" name="cluster2">
          </div>
        </section>
        
        <section id="manual">
          <header>
            <h1>Manual</h1>
          </header>

          <p>To use the <em>Cluster plugin</em> you need to:
            
            <ol>
              <li><b>Load a trajectory</b> of the conformations used for clustering into VMD.</li>
              <li>Define the <b>atom selection</b> and <b>molecule</b> to use as representation in vmd.</li>
              <li><b>Generate</b> the clusters with one of the following external utilities and <b>Import</b> the results into the plugin:
                <ul>
                  <li><b>NMRCLUSTER</b>: import the <em>"Cluster.log"</em> file. Only a level (0) will be available. Outliers will be splitted in different clusters. Use the <em>Join 1 member clusters</em> to cluster them together.</li>
                  <li><b>Xcluster</b>: import the <em>".clg"</em> file. All levels of interest must be saved in order to display them in VMD (look in the Xcluster manual for the <em>Writecls</em> command).</li>
                  <li><b>R</b>:
                    <ol>
                      <li>Obtain the rmsd between structures. You can use the <a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/itrajcomp">iTrajComp</a> plugin for and easy way of doing this (I suggest writing the results in matrix format).</li>
                      <li>Load the data into R and use one of the available functions in R to do hierarchical clustering (<em>hclust</em>, <em>agnes</em>, <em>diana</em>, ...). If you used the <a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/itrajcomp">iTrajComp</a> plugin to create the rmsd matrix, the following should work in R (see the documentation of the individual commands for further options):
                        <pre>
data = scan('/path/to/rmsd.mat')
rmsd = matrix(data, nrow=sqrt(length(data)), ncol=sqrt(length(data)))
library(cluster)
cluster = agnes(rmsd, diss=T)</pre>
                      </li>
                      <li>Cut the tree into groups (levels) using <em>cutree</em>. You can cut into one or more groupings. For example
                        <pre>
levels = cutree(cluster, k=2:5)</pre>
                        will output the cluster membership of each object for levels 2 to 5.
                      </li>
                      <li>Write the results to a file to input into the Cluster plugin:
                        <pre>
write.table(levels, file='levels.dat', quote=F)</pre>
                      </li>
                      <li>Import the file into the Cluster plugin.</li>
                    </ol>
                  </li>
                  <li><b>Gromacs (g_cluster)</b>: import the <em>"cluster.log"</em> file. Only a level (0) will be available. <em>g_cluster</em> timesteps are automatically mapped into VMD frames. <em>Thanks to Andrea Carotti for all his help with the testing</em>.</li>
                  <li><b>Charmm</b>: import the <em>output membership file</em> file.</li>
                </ul>
              </li>
              <li>Managing the GUI:
                <ul>
                  <li>Select the <b>level</b> you want to see. The list of clusters will be updated together with the colors of the conformations. All clusters will be displayed when you change the level.</li>
                  <li>Select/Deselect <b>clusters</b> to activate/deactivate them.</li>
                  <li>Select/Deselect <b>conformations</b> to activate/deactivate individual conformations.</li>
                  <li><b>All</b> and <b>None</b> turn on/off all the clusters and conformations.</li>
                  <li>Activate <b>Join 1 member clusters</b> to display all single member clusters in a separate cluster (<em>outl</em>).</li>
                  <li>The <b>atom selection</b> to represent can be changed in the atom selection box. Click the <em>Update Selection</em> button to apply the changes.</li>
                </ul>
              </li>
            </ol>
        </section>

        <section id="download">
          <header>
            <h1>Download</h1>
          </header>
          Send a mail to the <a href="#author">author</a> if you would like to be informed about new updates of this plugin.

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.7.tgz">download</a>]</span>
              <h1><a name="latest">1.7</a> (26 Feb'08)</h1>
            </header>
            <p>Change log:</p>
            <ul>
	      <li>Add support for cluster output from Gromacs utility g_cluster.</li>
	      <li>Fix colors when doing multiple imports.</li>
	      <li>Fix display of the 'outl' cluster.</li>
            </ul>
          </section>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.6.tgz">download</a>]</span>
              <h1>1.6 (13 Aug'07)</h1>
            </header>
            <p>Change log:</p>
            <ul>
	      <li>Added support for cluster output from R.</li>
	      <li>'Join 1 member' clusters works interactively (not just on import).</li>
	      <li>Upgraded number of colors to the vmd maximum.</li>
            </ul>
          </section>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.5.tgz">download</a>]</span>
              <h1>1.5 (6 Apr'05)</h1>
            </header>
            <p><b>Note:</b> Remember to change pkgIndex.tcl and the .vmdrc to reflect the change (see <a href="#install">Installation notes</a>).</p>
            <p>Change log:</p>
            <ul>
	      <li>Namespace changed from CLUSTER to clustering. There was a clash with another plugin new in VMD 1.8.3.</li>
            </ul>
          </section>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.4.tgz">download</a>]</span>
              <h1>1.4 (18 Jan'05)</h1>
            </header>
            <p>Change log:</p>
            <ul>
	      <li>Solved bug with colors when using more than 17 clusters.</li>
	      <li>Finished option to join cluster of 1 member together in cluster "outliers" (outl).</li>
	      <li>Selection of molecule recovered.</li>
	      <li>Parsing of Xcluster .clg file simplified.</li>
	      <li>Added button to change atom selection.</li>
            </ul>
          </section>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.3.tgz">download</a>]</span>
              <h1>1.3 (18 Jan'05)</h1>
            </header>
            <p>Change log:</p>
            <ul>
	      <li>Added support for Xcluster:
	        <ul>
	          <li>Added new listbox with levels of clustering. Added another dimension to cluster.</li>
	        </ul>
	      </li>
              <li>Added Options frame with:
	        <ul>
	          <li>Atom selection for the representations.</li>
	          <li>Starting to add option to join cluster of 1 member together, although is not activated yet.</li>
	        </ul>
	      </li>
              <li>Minimized number of representations. Now each representation holds one cluster instead of one conformation.
            </ul>
          </section>

          <section class="plugin">
            <header>
              <span>[<a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/cluster/versions/cluster-v1.2.tgz">download</a>]</span>
              <h1>1.2 (17 Aug'04)</h1>
            </header>
            <p>Initial version.</p>
          </section>
        </section>

        <section id="install">
          <header>
            <h1>Installation</h1>
          </header>
          <p>A small guide on how to install third party VMD plugins can be found <a href="http://physiology.med.cornell.edu/faculty/hweinstein/vmdplugins/installation.html">here</a>. In summary:</p>
            <pre>
set auto_path [linsert $auto_path 0 {/path/to/plugins/directory}]
vmd_install_extension clustering clustering "WMC PhysBio/Cluster"</pre>
            <p>The Cluster plugin should be accessible from the <em>Extensions menu</em>.</p>
        </section>

        <section id="author">
          <header>
            <h1>Author</h1>
          </header>
          <em>Luis Gracia, PhD
            <br/>Weill Cornell Medical College
            <br/>1300 York Ave, New York, 10065 NY</em>

          <p>Send comments and feedback to <a href="mailto:lug2002@med.cornell.edu">Luis Gracia</a>.</p>
        </section>
      </div>

      <footer>
        <span id="copyright">Copyright &copy; 2004-2011, Weill Cornell Medical College. All Rights Reserved</span>
        <address>
          <a href="mailto:lug2002@med.cornell.edu">Luis Gracia</a>
          | last updated: Thursday, August 4 2011
          <!--#config  timefmt="%A %e/%m/%y"--><!--#echo var="LAST_MODIFIED"-->
        </address>
      </footer>
    </div> 
  </body>
</html>
